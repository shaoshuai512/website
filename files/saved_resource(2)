M.add("www-header",function(e){e.namespace("mt.www");var n=e.mt.www,o=n.Ajax.io;e.mt.www.Header={init:function(){var n=e.one("#site-mast");n&&(this.getHotQuery(n),this.getCart(),this.getUserInfo())},getHotQuery:function(e){var n=e&&e.one(".J-search-box");n&&o(n,{mtData:{performanceLabel:"hot-query",ndModuleView:function(){return n.one(".J-search-box__hot")},useCache:!0,useBuffer:!0},on:{success:function(e,o){o&&o.html&&n.append(o.html)}}})},getCart:function(){var t=n.CartEx,a=e.one("#J-my-cart"),i=!1,r=a&&a.one("#J-my-cart-menu");r&&(a.once("mouseover",function(){i||r.addClass("dropdown-menu--loading")}),o(a,{mtData:{performanceLabel:"nav-cart",useCache:!0,useBuffer:!0},on:{success:function(e,n){n&&n.data&&(i=!0,t.update(n.data))}}}))},getUserInfo:function(){function n(){e.use("www-base",function(){document.domain=M.DOMAIN_HOST,e.mt.www.Iframe.setParentHeight(),e.mt.www.Iframe.scrollTop(),e.one(window).on("load",e.mt.www.Iframe.setParentHeight)})}function t(){if(window.top!==window.self){try{var e,n,o=/^http:\/\/([^\/]+)/,t=document.referrer.match(o),a=[".sankuai.com",".sankuai.info","action.tenpay.com","www.google.com"];if(t){if(e=t[1],window.location.href.indexOf("meituan.com/rising/")>=0&&e.indexOf("hao.rising.cn")>=0)return;for(var i=0;i<a.length;i++)if(n=e.indexOf(a[i]),n>=0&&n===e.length-a[i].length)return}else e=window.top.location.host;if(M.ROOT_HOST===e)return}catch(r){}setTimeout(function(){window.top.location=window.self.location,document.body.innerHTML=""},0),window.self.onload=function(){document.body.innerHTML=""}}}var a=e.one("#J-user-info-w");a&&o(a,{mtData:{performanceLabel:"nav-userinfo",ndLazyIconLoad:a,useCache:!0,useBuffer:!0},on:{success:function(e,o){o&&(o.html&&(a.addClass("J-logged"),a.setHTML(o.html)),o.union&&(t(),"cibshop"===o.union&&n()))}}})}}},"1.0.0",{requires:["www-base","www-ajax"]});
/*
YUI 3.12.0 (build 8655935)
Copyright 2013 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("transition",function(e,t){var n="",r="",i=e.config.doc,s="documentElement",o=i[s].style,u="transition",a="transitionProperty",f,l,c,h,p,d,v={},m=["Webkit","Moz"],g={Webkit:"webkitTransitionEnd"},y=function(){this.init.apply(this,arguments)};y._TRANSFORM="transform",y._toCamel=function(e){return e=e.replace(/-([a-z])/gi,function(e,t){return t.toUpperCase()}),e},y._toHyphen=function(e){return e=e.replace(/([A-Z]?)([a-z]+)([A-Z]?)/g,function(e,t,n,r){var i=(t?"-"+t.toLowerCase():"")+n;return r&&(i+="-"+r.toLowerCase()),i}),e},y.SHOW_TRANSITION="fadeIn",y.HIDE_TRANSITION="fadeOut",y.useNative=!1,"transition"in o&&"transitionProperty"in o&&"transitionDuration"in o&&"transitionTimingFunction"in o&&"transitionDelay"in o?(y.useNative=!0,y.supported=!0):e.Array.each(m,function(e){var t=e+"Transition";t in i[s].style&&(n=e,r=y._toHyphen(e)+"-",y.useNative=!0,y.supported=!0,y._VENDOR_PREFIX=e)}),typeof o.transform=="undefined"&&e.Array.each(m,function(e){var t=e+"Transform";typeof o[t]!="undefined"&&(y._TRANSFORM=t)}),n&&(u=n+"Transition",a=n+"TransitionProperty"),f=r+"transition-property",l=r+"transition-duration",c=r+"transition-timing-function",h=r+"transition-delay",p="transitionend",d="on"+n.toLowerCase()+"transitionend",p=g[n]||p,y.fx={},y.toggles={},y._hasEnd={},y._reKeywords=/^(?:node|duration|iterations|easing|delay|on|onstart|onend)$/i,e.Node.DOM_EVENTS[p]=1,y.NAME="transition",y.DEFAULT_EASING="ease",y.DEFAULT_DURATION=.5,y.DEFAULT_DELAY=0,y._nodeAttrs={},y.prototype={constructor:y,init:function(e,t){var n=this;return n._node=e,!n._running&&t&&(n._config=t,e._transition=n,n._duration="duration"in t?t.duration:n.constructor.DEFAULT_DURATION,n._delay="delay"in t?t.delay:n.constructor.DEFAULT_DELAY,n._easing=t.easing||n.constructor.DEFAULT_EASING,n._count=0,n._running=!1),n},addProperty:function(t,n){var r=this,i=this._node,s=e.stamp(i),o=e.one(i),u=y._nodeAttrs[s],a,f,l,c,h;u||(u=y._nodeAttrs[s]={}),c=u[t],n&&n.value!==undefined?h=n.value:n!==undefined&&(h=n,n=v),typeof h=="function"&&(h=h.call(o,o)),c&&c.transition&&c.transition!==r&&c.transition._count--,r._count++,l=(typeof n.duration!="undefined"?n.duration:r._duration)||1e-4,u[t]={value:h,duration:l,delay:typeof n.delay!="undefined"?n.delay:r._delay,easing:n.easing||r._easing,transition:r},a=e.DOM.getComputedStyle(i,t),f=typeof h=="string"?a:parseFloat(a),y.useNative&&f===h&&setTimeout(function(){r._onNativeEnd.call(i,{propertyName:t,elapsedTime:l})},l*1e3)},removeProperty:function(t){var n=this,r=y._nodeAttrs[e.stamp(n._node)];r&&r[t]&&(delete r[t],n._count--)},initAttrs:function(t){var n,r=this._node;t.transform&&!t[y._TRANSFORM]&&(t[y._TRANSFORM]=t.transform,delete t.transform);for(n in t)t.hasOwnProperty(n)&&!y._reKeywords.test(n)&&(this.addProperty(n,t[n]),r.style[n]===""&&e.DOM.setStyle(r,n,e.DOM.getComputedStyle(r,n)))},run:function(t){var n=this,r=n._node,i=n._config,s={type:"transition:start",config:i};return n._running||(n._running=!0,i.on&&i.on.start&&i.on.start.call(e.one(r),s),n.initAttrs(n._config),n._callback=t,n._start()),n},_start:function(){this._runNative()},_prepDur:function(e){return e=parseFloat(e)*1e3,e+"ms"},_runNative:function(){var t=this,n=t._node,r=e.stamp(n),i=n.style,s=n.ownerDocument.defaultView.getComputedStyle(n),o=y._nodeAttrs[r],u="",a=s[y._toCamel(f)],d=f+": ",v=l+": ",m=c+": ",g=h+": ",b,w,E;a!=="all"&&(d+=a+",",v+=s[y._toCamel(l)]+",",m+=s[y._toCamel(c)]+",",g+=s[y._toCamel(h)]+",");for(E in o)b=y._toHyphen(E),w=o[E],(w=o[E])&&w.transition===t&&(E in n.style?(v+=t._prepDur(w.duration)+",",g+=t._prepDur(w.delay)+",",m+=w.easing+",",d+=b+",",u+=b+": "+w.value+"; "):this.removeProperty(E));d=d.replace(/,$/,";"),v=v.replace(/,$/,";"),m=m.replace(/,$/,";"),g=g.replace(/,$/,";"),y._hasEnd[r]||(n.addEventListener(p,t._onNativeEnd,""),y._hasEnd[r]=!0),i.cssText+=d+v+m+g+u},_end:function(t){var n=this,r=n._node,i=n._callback,s=n._config,o={type:"transition:end",config:s,elapsedTime:t},u=e.one(r);n._running=!1,n._callback=null,r&&(s.on&&s.on.end?setTimeout(function(){s.on.end.call(u,o),i&&i.call(u,o)},1):i&&setTimeout(function(){i.call(u,o)},1))},_endNative:function(e){var t=this._node,n=t.ownerDocument.defaultView.getComputedStyle(t,"")[y._toCamel(f)];e=y._toHyphen(e),typeof n=="string"&&(n=n.replace(new RegExp("(?:^|,\\s)"+e+",?"),","),n=n.replace(/^,|,$/,""),t.style[u]=n)},_onNativeEnd:function(t){var n=this,r=e.stamp(n),i=t,s=y._toCamel(i.propertyName),o=i.elapsedTime,u=y._nodeAttrs[r],f=u[s],l=f?f.transition:null,c,h;l&&(l.removeProperty(s),l._endNative(s),h=l._config[s],c={type:"propertyEnd",propertyName:s,elapsedTime:o,config:h},h&&h.on&&h.on.end&&h.on.end.call(e.one(n),c),l._count<=0&&(l._end(o),n.style[a]=""))},destroy:function(){var e=this,t=e._node;t&&(t.removeEventListener(p,e._onNativeEnd,!1),e._node=null)}},e.Transition=y,e.TransitionNative=y,e.Node.prototype.transition=function(t,n,r){var i=y._nodeAttrs[e.stamp(this._node)],s=i?i.transition||null:null,o,u;if(typeof t=="string"){typeof n=="function"&&(r=n,n=null),o=y.fx[t];if(n&&typeof n!="boolean"){n=e.clone(n);for(u in o)o.hasOwnProperty(u)&&(u in n||(n[u]=o[u]))}else n=o}else r=n,n=t;return s&&!s._running?s.init(this,n):s=new y(this._node,n),s.run(r),this},e.Node.prototype.show=function(t,n,r){return this._show(),t&&e.Transition&&(typeof t!="string"&&!t.push&&(typeof n=="function"&&(r=n,n=t),t=y.SHOW_TRANSITION),this.transition(t,n,r)),this},e.NodeList.prototype.show=function(t,n,r){var i=this._nodes,s=0,o;while(o=i[s++])e.one(o).show(t,n,r);return this};var b=function(e,t,n){return function(){t&&t.call(e),n&&typeof n=="function"&&n.apply(e._node,arguments)}};e.Node.prototype.hide=function(t,n,r){return t&&e.Transition?(typeof n=="function"&&(r=n,n=null),r=b(this,this._hide,r),typeof t!="string"&&!t.push&&(typeof n=="function"&&(r=n,n=t),t=y.HIDE_TRANSITION),this.transition(t,n,r)):this._hide(),this},e.NodeList.prototype.hide=function(t,n,r){var i=this._nodes,s=0,o;while(o=i[s++])e.one(o).hide(t,n,r);return this},e.NodeList.prototype
.transition=function(t,n){var r=this._nodes,i=0,s;while(s=r[i++])e.one(s).transition(t,n);return this},e.Node.prototype.toggleView=function(t,n,r){this._toggles=this._toggles||[],r=arguments[arguments.length-1];if(typeof t!="string"){n=t,this._toggleView(n,r);return}return typeof n=="function"&&(n=undefined),typeof n=="undefined"&&t in this._toggles&&(n=!this._toggles[t]),n=n?1:0,n?this._show():r=b(this,this._hide,r),this._toggles[t]=n,this.transition(e.Transition.toggles[t][n],r),this},e.NodeList.prototype.toggleView=function(t,n,r){var i=this._nodes,s=0,o;while(o=i[s++])o=e.one(o),o.toggleView.apply(o,arguments);return this},e.mix(y.fx,{fadeOut:{opacity:0,duration:.5,easing:"ease-out"},fadeIn:{opacity:1,duration:.5,easing:"ease-in"},sizeOut:{height:0,width:0,duration:.75,easing:"ease-out"},sizeIn:{height:function(e){return e.get("scrollHeight")+"px"},width:function(e){return e.get("scrollWidth")+"px"},duration:.5,easing:"ease-in",on:{start:function(){var e=this.getStyle("overflow");e!=="hidden"&&(this.setStyle("overflow","hidden"),this._transitionOverflow=e)},end:function(){this._transitionOverflow&&(this.setStyle("overflow",this._transitionOverflow),delete this._transitionOverflow)}}}}),e.mix(y.toggles,{size:["sizeOut","sizeIn"],fade:["fadeOut","fadeIn"]})},"3.12.0",{requires:["node-style"]});

M.add("www-tips",function(e){var t=e.Node,n=e.UA.ie,s=e.mt.www,i=s.Ajax.io,o=e.mt.util,a=o.Cookie;e.mt.www.SysMsg={show:function(n,s){var i,o,a,c,r=e.all("#doc .sysmsgw");r.size()?i=r.item(0):(i=t.create('<div class="sysmsgw common-tip"><div class="sysmsg"><span class="J-msg-content"></span><span class="close common-close">关闭</span></div></div>'),c=e.one("#hdw")||e.one("#site-mast"),c.insert(i,"after")),o=i.one(".J-tip-status"),o&&o.remove(!0),o=t.create('<span class="J-tip-status tip-status"></span>'),o.addClass("tip-status--"+n),a=i.one(".J-msg-content, p"),a.setHTML(s),i.set("id","sysmsg-"+n),i.insertBefore(o,a),this.initEvent()},remove:function(t){var n=e.all("#doc .sysmsgw");n.size()&&(t?n.remove(!0):n.item(0).remove(!0))},initEvent:function(){var t=e.one("#sysmsg-error, #sysmsg-success");t&&t.delegate("click",function(){t.remove(!0)},".close")},init:function(t,s){if(t){var i,c="systip";i=t._node?t:e.Node.create(t),s=s&&e.one(s)||e.one("body"),s.prepend(i),e.Global.fire("PageHeight:change"),n&&8>n&&o.reflow(),i.delegate("click",function(){var e=o.decodeAttr(i,"params");if(e&&e.cookieClose){var t=a.getExpiresDate(15,0,0);a.set(c,!0,t,"/","."+M.DOMAIN_HOST)}i.remove(!0),6===n&&o.reflow()},".close")}}},e.mt.www.CommonTips={_isFirstMsg:!0,init:function(t,s,i){function a(t,n){var i;s=o.getEvalRes(n),0!==s.status&&s.msg?(i="<p>"+s.msg+"</p>",l.setAttribute("gaevent",s.gaevent)):d=!0,d?c.effect.fadeOut(!1,200,function(){e.Global.fire("PageHeight:change")}):c.effect.fadeOutSimple(!1,200,function(){m.show(c,i)})}if(t){var c;c=t._node?t:e.Node.create(t),i=i&&e.one(i)||e.one("body"),i.prepend(c),c.show(),e.Global.fire("PageHeight:change"),n&&8>n&&o.reflow();var r,l=c.one(".close"),u=o.decodeAttr(c,"commontips"),d=!1,m=this;c.plug(e.mt.plugin.Effect),c.delegate("click",function(){if(!(r&&r.isInProgress()||d)){var t={};s&&(s.type&&(t.type=s.type),s.msgid&&(t.msgid=s.msgid)),r=e.io("/index/commontips",{method:"POST",data:e.merge(u,t),on:{success:a}})}},".close")}},show:function(e,t){var s=e.one(".content");s.setHTML(t),e.effect.fadeInSimple("middle",function(){n&&8>n&&o.reflow()}),this.trackViewEvent(e)},trackViewEvent:function(e){var t="ga-params",n=e.all("[data-"+t+"]");n.each(function(e){var n=o.data(e,t).split("|");_gaq.push(["_trackEvent"].concat(n))})}},e.mt.www.VipBubble={init:function(){var t=e.one(".site-mast__user-nav"),n=e.one("#J-push-bubble");if(t)return n?void this.bindPushBubble():void i(t,{mtData:{useCache:!0,useBuffer:!0},on:{success:function(n,s){s.status&&s.markup&&(t.append(s.markup),e.mt.www.VipBubble.bindBubbleEvents(!!s.noticeType,t))}}})},bindPushBubble:function(){var t,n=e.one("#J-push-bubble"),s="pbc",i=a.get(s);i||(n.show(),n.delegate("click",function(){t=a.getExpiresDate(20,0,0),a.set(s,!0,t,"/","."+M.DOMAIN_HOST),n.hide()},".close"))},bindBubbleEvents:function(t,n){function s(){g||r||!t||c.addClass("growth-info--open")}function i(){m.delegate("click",function(){c.removeClass("growth-info--open"),a.set(f,!0,u,"/","."+M.DOMAIN_HOST)},".close")}var c,r,l,u,d,m=e.one("#J-growth-bubble"),g=!1,f="vbc";c=n,r=a.get(f),u=a.getExpiresDate(20,0,0),d=o.data(m,"pageview"),l=["/account/viprewards","/deal/verify/","/deal/buy","/order/check/","/cart/"],e.each(l,function(e){return 0===d.indexOf(e)?(g=!0,!1):void 0}),s(),i()}},e.mt.www.MsgCenter={init:function(){function t(){for(var e=["/deal/buy/","/order/check/","/order/return/"],t=document.location.pathname,n=0;n<e.length;n++)if(0===t.indexOf(e[n]))return!1;return!0}var n=e.one("#J-my-msg"),s=n&&n.ancestor(".J-my-msg-w"),o=this;n&&i(s,{mtData:{useCache:!0,useBuffer:!0},on:{success:function(i,a){var c=a.total;a.msglist&&(s.show(),s.appendChild(a.msglist),n.on("hover",function(){o.initScroll(e.one("#J-header-msg-list"))}),c>0&&t()&&n.one(".J-title").insert('<span class="J-msg-count msg-count">'+c+"</span>","after"))}}})},bindMsgEvent:function(t,n,s,i){function o(t,n,s){n&&e.io(t,{method:"POST",data:{msgid:n.getData("mid")},on:{success:s}})}function a(t){var n=0,s=e.one("#J-my-msg .J-msg-count");t.hasClass("isread")||s&&(n=parseInt(s.get("innerHTML"),10),n--,n>0?s.setHTML(n):s.ancestor().remove(!0))}t=e.one(t),i=i||"nav",t&&(t.delegate("click",function(e){var t,s,c=e.target.hasClass("J-close");c||(t="a"===this.get("tagName").toLowerCase()?this.ancestor("li"):this,e.halt(),o("/message/read",t,function(){a(t),t.addClass("isread"),n&&n()}),s=this.getAttribute("href"),window._gaq.push(["_trackEvent","InnerLink","Click",i+"/drop/msgread/"+t.getData("mid")]),s?window.open(s,"_blank"):"J-header-msg-list"===t.ancestor("ul").get("id")&&window.open("/message/","_blank"))},"a, li"),t.delegate("click",function(){var e=this.ancestor("li");e.hide(200,null,function(){t.all("[data-mid]").some(function(e){return"none"!==e.getStyle("display")})||t.replace('<p class="no-msg">暂无新消息</p>'),o("/message/delete",e,function(){a(e)}),s&&s(),window._gaq.push(["_trackEvent","InnerLink","Click",i+"/drop/msgdel/"+e.getData("mid")])})},".J-close"),t.delegate("hover",function(){this.addClass("current")},function(){this.removeClass("current")},"li"))},initScroll:function(t){function n(){a=t.get("scrollHeight"),c=parseInt(t.get("clientHeight"),10),r=c-2*h,f=t.get("scrollTop"),l=r/a,g.setStyles(c>=a?{height:"0px",top:h+"px",right:"2px"}:{height:l*c+"px",top:f*l+h+"px",right:"2px"})}function s(){t.on("hover",function(){d=o()},function(){d&&d.detach()})}function i(){return window.setTimeout(function(){g.setStyle("opacity","0")},w)}function o(){return t.on({mousewheel:function(e){e.halt(!0),u&&(window.clearTimeout(u),u=null),g.setStyle("opacity","0.5"),u=i(),(e.wheelDelta*v<=0||f>=0&&a-c>=f)&&(e.wheelDelta>0?(f-=p,v=1):(f+=p,v=-1)),0>f?f=0:f>=a-c&&(f=a-c),g.setStyle("opacity",.5),g.setStyle("top",f*l+h),t.set("scrollTop",f)}})}if(t){var a,c,r,l,u,d,m='<div class="scroll-bar"></div>',g=e.Node.create(m),f=0,p=20,w=2e3,h=10,v=0;if(window._gaq.push(["_trackEvent","InnerLink","Click","nav/drop/mymsg"]),t.next(".scroll-bar"))return g=t.next(".scroll-bar"),g.setStyle("opacity","0.5"),void i();t.ancestor().appendChild(g),this.bindMsgEvent(t,null,function(){n()}),window.setTimeout(function(){n(),u=i(),s()},200)}}},e.mt.www.Tips={init:function(){this.getYellowTips(),s.VipBubble.init(),s.MsgCenter.init()},getYellowTips:function(){var t=e.mt.www.SysMsg,n=e.mt.www.CommonTips,s=e.one("#J-async-tips");if(s){var o=s.getData("parent");i(s,{mtData:{useCache:!0,useBuffer:!0},on:{success:function(e,s){s&&(s.sysmsg?t.init(s.sysmsg,o):s.commontips&&n.init(s.commontips.html,s.commontips.info,o))}}})}}}},"1.0.0",{requires:["transition","www-base","www-ajax"]});
M.add("www-recommend",function(e){var o=e.mt.www.Ajax.io,t=e.mt.util,n=t.Cookie;e.mt.www.Recommend={initNavRecentlyViewed:function(){var n,i=e.one("#J-my-history-toggle"),a="dropdown-menu--empty",r="dropdown-menu--loading";return i?(n=i.next("#J-my-history-menu"),n.delegate("click",function(e){e.halt(),t.Cookie.remove("rvd","/","."+M.DOMAIN_HOST),n.setHTML('<p class="'+a+'">暂无浏览记录</p>'),i.ancestor().removeClass("dropdown--open").removeClass("dropdown--open-history")},"#J-clear-my-history"),void i.once("mouseover",function(){n.addClass(r),o("/index/rvd",{mtData:{useCache:!0},method:"GET",on:{success:function(e,o){o.html&&(n.setHTML(o.html),n.removeClass(r))}}})})):null},initSideRecentlyViewed:function(){var t=e.one(".J-side-history");return t?(t.delegate("click",function(){t.one(".J-history-list").remove(),t.append('<div class="no-history">暂无浏览记录</div>'),n.remove("rvd","/","."+M.DOMAIN_HOST)},".J-clear"),void o("/index/sidehistory",{mtData:{useCache:!0,useBuffer:!0},method:"GET",on:{success:function(o,n){var i=n.data;i&&i.html&&(t.setHTML(i.html),t.show(),e.use("mt-scrollloader",function(e){e.mt.ScrollLoader.Image.init({ndContainer:t})}),M.loadQueue.push(function(){e.use("p-node-sticky","mt-log",function(e){t.plug(e.mt.plugin.Sticky,{bottomEdge:e.one(".J-mall")||e.one("#content"),isStaticBottomEdge:!1}),i.trackData&&(i.trackData.url="nav/recent",e.mt.log.moduleview(i.trackData))})}))}}})):null}}},"1.0.0",{requires:["www-ajax","www-base"]});